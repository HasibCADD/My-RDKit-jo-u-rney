#Looping Over Atoms

aspirin = Chem.MolFromSmiles('CC(=O)Oc1ccccc1C(=O)O')
aspirin = Chem.AddHs(aspirin)  # Show explicit H for better demo

print("Total atoms (including H):", aspirin.GetNumAtoms())
# Output: ~22 (13 heavy + hydrogens)

# Loop through every atom
for atom in aspirin.GetAtoms():
    idx = atom.GetIdx()                   # Number (0, 1, 2...)
    symbol = atom.GetSymbol()             # C, O, H
    degree = atom.GetDegree()             # How many bonds it has
    charge = atom.GetFormalCharge()       # Usually 0
    aromatic = atom.GetIsAromatic()       # True/False
    
    print(f"Atom {idx}: {symbol:<2} | bonds: {degree} | charge: {charge} | aromatic: {aromatic}")



Draw.MolToImage(aspirin)
aspirin




#Looping over Bonds

print("\nBonds:")
for bond in aspirin.GetBonds():
    start = bond.GetBeginAtomIdx()
    end = bond.GetEndAtomIdx()
    bond_type = bond.GetBondType()        # SINGLE, DOUBLE, AROMATIC
    aromatic = bond.GetIsAromatic()
    
    print(f"Bond {start}-{end}: {bond_type} | aromatic: {aromatic}")


# finding specific atom

# Find all oxygen atoms
oxygens = [atom for atom in aspirin.GetAtoms() if atom.GetSymbol() == 'O']

print("Found", len(oxygens), "oxygen atoms")

for o_atom in oxygens:
    idx = o_atom.GetIdx()
    neighbors = [n.GetSymbol() for n in o_atom.GetNeighbors()]
    print(f"Oxygen {idx} connected to: {neighbors}")
